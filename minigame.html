<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorldBox Simulador</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #87CEEB; /* Color de fondo del cielo */
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #game {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(20px, 1fr));
            grid-template-rows: repeat(auto-fill, minmax(20px, 1fr));
            gap: 1px;
            border: 2px solid #444;
            background-color: #A0522D; /* Color de fondo del terreno */
            width: 90vw;
            max-width: 800px;
            margin: 20px 0;
        }
        .cell {
            width: 20px;
            height: 20px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        /* Colores de biomas y terrenos */
        .cell.grass { background-color: #7CFC00; } /* Hierba */
        .cell.water { background-color: #1E90FF; } /* Agua */
        .cell.fire { background-color: #FF4500; } /* Fuego */
        .cell.mountain { background-color: #8B4513; } /* Montaña */
        .cell.sand { background-color: #FFD700; } /* Arena */
        .cell.tree { background-color: #228B22; } /* Árbol */
        .cell.stone { background-color: #808080; } /* Piedra */
        .cell.lava { background-color: #FF6347; } /* Lava */
        .cell.swamp { background-color: #4B5320; } /* Pantano */
        .cell.tundra { background-color: #B0E0E6; } /* Tundra */
        .cell.desert { background-color: #EDC9AF; } /* Desierto */
        .cell.volcano { background-color: #B22222; } /* Volcán */
        .cell.forest { background-color: #6B8E23; } /* Bosque */
        .cell.ocean { background-color: #00008B; } /* Océano */
        /* Aquí puedes agregar más biomas y terrenos */

        .fire-animation {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(255, 165, 0, 0.8) 0%, rgba(255, 0, 0, 0) 70%);
            animation: flicker 0.5s infinite alternate;
        }
        @keyframes flicker {
            0% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .toolbar {
            text-align: center;
            margin: 10px;
        }
        .tool {
            display: inline-block;
            padding: 10px;
            border: 1px solid #444;
            background-color: #fff;
            cursor: pointer;
            margin: 5px;
        }
        .tool.selected {
            border: 2px solid #FF4500; /* Resaltar la herramienta seleccionada */
        }
        
        .entity {
            width: 18px;
            height: 18px;
            position: absolute;
            background-color: #FF0000; /* Color del humano */
            border-radius: 50%; /* Forma redonda */
            transition: transform 0.5s;
        }

        .animal {
            background-color: #0000FF; /* Color del animal */
        }

        .info-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #444;
            max-width: 200px;
        }

        @media (max-width: 600px) {
            .cell {
                width: 15px;
                height: 15px;
            }
            .fire-animation {
                width: 15px;
                height: 15px;
            }
        }
    </style>
</head>
<body>

<div class="info-panel" id="infoPanel">
    <h3>Estado del Mapa</h3>
    <div id="humanCount">Humanos: 0</div>
    <div id="animalCount">Animales: 0</div>
    <div id="actions">Acciones: Ninguna</div>
</div>

<div class="toolbar">
    <div class="tool" id="grass" onclick="selectTool('grass')">Hierba</div>
    <div class="tool" id="water" onclick="selectTool('water')">Agua</div>
    <div class="tool" id="fire" onclick="selectTool('fire')">Fuego</div>
    <div class="tool" id="mountain" onclick="selectTool('mountain')">Montaña</div>
    <div class="tool" id="sand" onclick="selectTool('sand')">Arena</div>
    <div class="tool" id="tree" onclick="selectTool('tree')">Árbol</div>
    <div class="tool" id="stone" onclick="selectTool('stone')">Piedra</div>
    <div class="tool" id="lava" onclick="selectTool('lava')">Lava</div>
    <div class="tool" id="swamp" onclick="selectTool('swamp')">Pantano</div>
    <div class="tool" id="tundra" onclick="selectTool('tundra')">Tundra</div>
    <div class="tool" id="meteor" onclick="selectTool('meteor')">Meteorito</div>
    <div class="tool" id="dynamite" onclick="selectTool('dynamite')">Dinamita</div>
    <!-- Agrega más herramientas aquí -->
</div>

<div id="game"></div>

<script>
    const game = document.getElementById('game');
    const infoPanel = document.getElementById('infoPanel');
    const humanCount = document.getElementById('humanCount');
    const animalCount = document.getElementById('animalCount');
    const actions = document.getElementById('actions');

    const gridWidth = 40; // Ancho de la cuadrícula
    const gridHeight = 30; // Alto de la cuadrícula
    let selectedTool = 'grass';
    let entities = []; // Lista para guardar entidades (humanos y animales)
    let humans = 0; // Contador de humanos
    let animals = 0; // Contador de animales

    // Crear la cuadrícula de bloques
    for (let x = 0; x < gridWidth; x++) {
        for (let y = 0; y < gridHeight; y++) {
            const cell = document.createElement('div');
            cell.classList.add('cell', 'grass'); // Inicialmente, todas las celdas son de hierba
            cell.dataset.x = x;
            cell.dataset.y = y;
            cell.addEventListener('click', () => updateCell(cell));
            game.appendChild(cell);
        }
    }

    // Función para actualizar la celda según la herramienta seleccionada
    function updateCell(cell) {
        if (selectedTool === 'fire' && cell.classList.contains('water')) {
            return; // El fuego no puede colocarse en el agua
        }

        // Cambiar la celda al tipo de herramienta seleccionada
        cell.className = `cell ${selectedTool}`;
        
        // Actualizar el estado del mapa
        actions.textContent = `Acción: Cambiar a ${selectedTool}`;
        
        // Propagación del fuego
        if (selectedTool === 'fire') {
            setFireSpread(cell);
        } else if (selectedTool === 'tree') {
            growTree(cell);
        } else if (selectedTool === 'lava') {
            spreadLava(cell);
        } else if (selectedTool === 'meteor') {
            dropMeteor(cell);
        } else if (selectedTool === 'dynamite') {
            explode(cell);
        }
    }

    // Función para seleccionar la herramienta
    function selectTool(tool) {
        selectedTool = tool;
        document.querySelectorAll('.tool').forEach(t => t.classList.remove('selected'));
        document.getElementById(tool).classList.add('selected');
        actions.textContent = `Herramienta seleccionada: ${tool}`;
    }

    // Función para propagar el fuego
    function setFireSpread(cell) {
        const x = parseInt(cell.dataset.x);
        const y = parseInt(cell.dataset.y);
        
        const neighbors = [
            { x: x - 1, y: y }, // izquierda
            { x: x + 1, y: y }, // derecha
            { x: x, y: y - 1 }, // arriba
            { x: x, y: y + 1 }  // abajo
        ];

        neighbors.forEach(neighbor => {
            if (isInBounds(neighbor.x, neighbor.y)) {
                const neighborCell = document.querySelector(`.cell[data-x="${neighbor.x}"][data-y="${neighbor.y}"]`);
                if (neighborCell && neighborCell.classList.contains('grass')) {
                    neighborCell.className = 'cell fire';
                    actions.textContent = "Acción: Propagando fuego.";
                    setTimeout(() => setFireSpread(neighborCell), 2000);
                }
            }
        });
    }

    // Función para hacer crecer un árbol en una celda
    function growTree(cell) {
        const x = parseInt(cell.dataset.x);
        const y = parseInt(cell.dataset.y);
        const treeCell = document.querySelector(`.cell[data-x="${x}"][data-y="${y}"]`);
        if (treeCell && treeCell.classList.contains('grass')) {
            treeCell.className = 'cell tree';
            actions.textContent = "Acción: Crecer un árbol.";
        }
    }

    // Función para propagar lava
    function spreadLava(cell) {
        const x = parseInt(cell.dataset.x);
        const y = parseInt(cell.dataset.y);
        
        const neighbors = [
            { x: x - 1, y: y }, // izquierda
            { x: x + 1, y: y }, // derecha
            { x: x, y: y - 1 }, // arriba
            { x: x, y: y + 1 }  // abajo
        ];

        neighbors.forEach(neighbor => {
            if (isInBounds(neighbor.x, neighbor.y)) {
                const neighborCell = document.querySelector(`.cell[data-x="${neighbor.x}"][data-y="${neighbor.y}"]`);
                if (neighborCell && neighborCell.classList.contains('grass')) {
                    neighborCell.className = 'cell lava';
                    actions.textContent = "Acción: Propagando lava.";
                }
            }
        });
    }

    // Función para lanzar un meteorito
    function dropMeteor(cell) {
        const x = parseInt(cell.dataset.x);
        const y = parseInt(cell.dataset.y);
        
        // Simular un impacto de meteorito
        const meteoriteRadius = 2; // Radio de impacto
        for (let i = -meteoriteRadius; i <= meteoriteRadius; i++) {
            for (let j = -meteoriteRadius; j <= meteoriteRadius; j++) {
                const neighborCell = document.querySelector(`.cell[data-x="${x + i}"][data-y="${y + j}"]`);
                if (neighborCell) {
                    neighborCell.className = 'cell stone'; // Cambiar el terreno impactado
                }
            }
        }
        actions.textContent = "Acción: Meteorito caído.";
    }

    // Función para explotar una celda
    function explode(cell) {
        const x = parseInt(cell.dataset.x);
        const y = parseInt(cell.dataset.y);
        
        // Cambiar celdas alrededor a piedra
        const explosionRadius = 1; // Radio de explosión
        for (let i = -explosionRadius; i <= explosionRadius; i++) {
            for (let j = -explosionRadius; j <= explosionRadius; j++) {
                const neighborCell = document.querySelector(`.cell[data-x="${x + i}"][data-y="${y + j}"]`);
                if (neighborCell) {
                    neighborCell.className = 'cell fire'; // Cambiar el terreno afectado a fuego
                }
            }
        }
        actions.textContent = "Acción: Explosión de dinamita.";
    }

    // Verificar si la celda está dentro de los límites
    function isInBounds(x, y) {
        return x >= 0 && x < gridWidth && y >= 0 && y < gridHeight;
    }

    // Crear entidades (humanos y animales)
    function createEntity(type, x, y) {
        const entity = document.createElement('div');
        entity.className = `entity ${type}`;
        entity.style.left = `${x * 20}px`;
        entity.style.top = `${y * 20}px`;
        game.appendChild(entity);
        entities.push(entity);
        if (type === 'human') {
            humans++;
            humanCount.textContent = `Humanos: ${humans}`;
        } else if (type === 'animal') {
            animals++;
            animalCount.textContent = `Animales: ${animals}`;
        }
    }

    // Generar entidades aleatorias cada 3 segundos
    setInterval(() => {
        const x = Math.floor(Math.random() * gridWidth);
        const y = Math.floor(Math.random() * gridHeight);
        if (Math.random() < 0.5) {
            createEntity('human', x, y);
        } else {
            createEntity('animal', x, y);
        }
    }, 3000);

    // Movimiento básico de entidades
    function moveEntities() {
        entities.forEach(entity => {
            const x = parseInt(entity.style.left) / 20;
            const y = parseInt(entity.style.top) / 20;

            const newX = x + Math.floor(Math.random() * 3) - 1; // Moverse en X
            const newY = y + Math.floor(Math.random() * 3) - 1; // Moverse en Y

            if (isInBounds(newX, newY)) {
                entity.style.left = `${newX * 20}px`;
                entity.style.top = `${newY * 20}px`;
            }
        });
    }

    // Llamar a la función de movimiento de entidades cada 1 segundo
    setInterval(moveEntities, 1000);

</script>

</body>
</html>
